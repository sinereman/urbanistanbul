<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Urban Istanbul - İnteraktif Keşif Haritası</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600&family=Roboto:wght@300;400&display=swap" rel="stylesheet">

    <style>
        /* TEMEL AYARLAR */
        body, html { 
            margin: 0; padding: 0; 
            height: 100%; width: 100%; 
            overflow: hidden; 
            font-family: 'Roboto', sans-serif; 
            -webkit-touch-callout: none;
            user-select: none;
        }
        
        /* HARİTA */
        #map { 
            position: absolute; 
            top: 0; bottom: 0; left: 0; right: 0; 
            width: 100%; height: 100%; 
            z-index: 1; 
            background: #e0e0e0;
        }

        /* HEADER (Bilgi Paneli) */
        .header {
            position: fixed; 
            top: 20px; left: 20px;
            background: rgba(0, 0, 0, 0.95); color: #fff;
            padding: 20px 25px; border-left: 5px solid #f1c40f;
            z-index: 2000; 
            max-width: 300px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.5); 
            border-radius: 0 0 10px 0;
            max-height: 85vh; overflow-y: auto; 
        }
        
        .site-logo { width: auto; max-width: 100%; height: auto; max-height: 100px; display: block; margin-bottom: 10px; }
        .header-text p { margin: 5px 0 0; font-family: 'Oswald', sans-serif; font-size: 14px; color: #f1c40f; text-transform: uppercase; }
        .info-note { font-size: 11px; color: #aaa; margin-top: 8px; border-top: 1px solid #333; padding-top: 5px; }

        /* FİLTRE MENÜSÜ */
        .leaflet-top.leaflet-right { margin-top: 10px; margin-right: 10px; z-index: 2001; }
        .leaflet-control-layers {
            background: rgba(0, 0, 0, 0.9) !important;
            color: #fff !important;
            border: none !important;
            border-radius: 8px !important;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3) !important;
            padding: 8px 12px !important;
            font-family: 'Roboto', sans-serif;
            font-size: 13px;
        }
        .leaflet-control-layers-separator { border-top: 1px solid #444; }

        /* POPUP TASARIMI */
        .leaflet-popup-content-wrapper { border-radius: 0; padding: 0; overflow: hidden; }
        .leaflet-popup-content { margin: 0; width: 260px !important; } 
        .popup-img { width: 100%; height: 140px; object-fit: cover; display: block; }
        .popup-details { padding: 12px; background: #fff; }
        .popup-details h3 { margin: 0 0 5px; font-family: 'Oswald', sans-serif; text-transform: uppercase; color: #222; font-size: 16px; }
        .category-tag { font-size: 10px; padding: 3px 8px; border-radius: 3px; color: #fff; font-weight: bold; text-transform: uppercase; display: inline-block; margin-bottom: 8px; }
        .btn-rota { display: block; text-align: center; background: #222; color: #fff; text-decoration: none; padding: 10px; font-weight: bold; font-size: 12px; text-transform: uppercase; transition: 0.3s; }
        .btn-rota:hover { background: #f1c40f; color: #000; }

        /* MOBİL UYUMLULUK */
        @media (max-width: 768px) {
            .header {
                top: auto; bottom: 0; left: 0; right: 0; 
                width: 100%; max-width: none;
                border-radius: 15px 15px 0 0;
                border-left: none; border-top: 4px solid #f1c40f;
                padding: 10px 20px;
                display: flex; align-items: center; justify-content: flex-start; gap: 15px; 
                height: 80px; 
            }
            .site-logo { height: 50px; width: auto; margin-bottom: 0; flex-shrink: 0; }
            .header-text { flex-grow: 1; }
            .info-note { display: none; } 
            .leaflet-bottom.leaflet-right { bottom: 90px !important; right: 10px !important; }
            .leaflet-control-layers-expanded { max-width: 200px; font-size: 12px; }
        }

        /* RENK KODLARI */
        .cat-tarih { background-color: #e74c3c; } /* Kırmızı */
        .cat-park { background-color: #2ecc71; } /* Yeşil */
        .cat-muze { background-color: #9b59b6; } /* Mor */
        .cat-modern { background-color: #3498db; } /* Mavi */
        .cat-meydan { background-color: #e67e22; } /* Turuncu */
        .cat-ibb { background-color: #f1c40f; color: #000; } /* Sarı - İBB */
        .cat-iskele { background-color: #7f8c8d; } /* Gri - Ulaşım */
    </style>
</head>
<body>

    <div class="header">
        <img src="logo.png" alt="Urban Istanbul" class="site-logo">
        <div class="header-text">
            <p>İstanbul Keşif Rehberi</p>
        </div>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        var map = L.map('map', { 
            center: [41.035, 29.000], 
            zoom: 12, 
            zoomControl: false,
            tap: true 
        });
        
        L.control.zoom({ position: 'bottomright' }).addTo(map);
        
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { 
            attribution: '© Urban Istanbul', subdomains: 'abcd', maxZoom: 20 
        }).addTo(map);

        // İKONLAR
        var LeafIcon = L.Icon.extend({ options: { shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png', iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41] }});
        
        var redIcon = new LeafIcon({iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png'});
        var greenIcon = new LeafIcon({iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png'});
        var blueIcon = new LeafIcon({iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png'});
        var violetIcon = new LeafIcon({iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-violet.png'});
        var orangeIcon = new LeafIcon({iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png'});
        var goldIcon = new LeafIcon({iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png'}); // İBB İçin
        var greyIcon = new LeafIcon({iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png'}); // İskele İçin

        // KATMAN GRUPLARI
        var layerTarih = L.layerGroup();
        var layerPark = L.layerGroup();
        var layerMeydan = L.layerGroup();
        var layerMuze = L.layerGroup();
        var layerModern = L.layerGroup();
        var layerIBB = L.layerGroup();
        var layerIskele = L.layerGroup();

        var locations = [
            // --- İBB SOSYAL TESİSLERİ (Yeni - Sarı) ---
            { title: "İBB Arnavutköy Sosyal Tesisi", lat: 41.0672, lng: 29.0432, type: "cat-ibb", category: "Ucuz Yemek & Manzara", desc: "Boğaz'ın içinde, ahşap mimarili uygun fiyatlı restoran.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Emirgan_Park_Yellow_Pavilion.jpg/640px-Emirgan_Park_Yellow_Pavilion.jpg" }, // Temsili
            { title: "İBB Çamlıca Sosyal Tesisi", lat: 41.0267, lng: 29.0664, type: "cat-ibb", category: "Ucuz Yemek & Manzara", desc: "Tepeden panoramik İstanbul manzarası eşliğinde yemek.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Camlica_Hill_View.jpg/640px-Camlica_Hill_View.jpg" },
            { title: "İBB Haliç Sosyal Tesisi", lat: 41.0250, lng: 28.9600, type: "cat-ibb", category: "Ucuz Yemek", desc: "Haliç kıyısında, sakin ve lezzetli bir durak.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Rahmi_M_Koc_Museum_Istanbul_submarine.jpg/640px-Rahmi_M_Koc_Museum_Istanbul_submarine.jpg" }, // Temsili (Haliç)
            { title: "İBB Fethipaşa Sosyal Tesisi", lat: 41.0335, lng: 29.0280, type: "cat-ibb", category: "Koru & Yemek", desc: "Üsküdar korusunun içinde, Sarayburnu manzaralı.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Fethi_Pasa_Korusu.jpg/640px-Fethi_Pasa_Korusu.jpg" },
            { title: "İBB Cihangir Sosyal Tesisi", lat: 41.0311, lng: 28.9833, type: "cat-ibb", category: "Manzara & Çay", desc: "Sanatçılar Parkı içinde, Boğaz'a nazır en ucuz çay.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Galata_Tower_Istanbul.jpg/640px-Galata_Tower_Istanbul.jpg" }, // Temsili (Yakın Konum)
            { title: "İBB İstinye Sosyal Tesisi", lat: 41.1132, lng: 29.0553, type: "cat-ibb", category: "Sahil & Yemek", desc: "İstinye koyunda denize sıfır keyif.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/Rumelihisari_Istanbul_Turkey.jpg/640px-Rumelihisari_Istanbul_Turkey.jpg" }, // Temsili

            // --- VAPUR İSKELELERİ (Yeni - Gri) ---
            { title: "Eminönü Vapur İskelesi", lat: 41.0150, lng: 28.9730, type: "cat-iskele", category: "Ulaşım", desc: "Boğaz ve Kadıköy vapurlarının ana merkezi.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Eminonu_Square_Istanbul.jpg/640px-Eminonu_Square_Istanbul.jpg" },
            { title: "Kadıköy Vapur İskelesi", lat: 40.9910, lng: 29.0220, type: "cat-iskele", category: "Ulaşım", desc: "Asya yakasının dünyaya açılan kapısı.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Haydarpasa_Terminal_Istanbul.jpg/640px-Haydarpasa_Terminal_Istanbul.jpg" }, // Temsili
            { title: "Beşiktaş Vapur İskelesi", lat: 41.0415, lng: 29.0060, type: "cat-iskele", category: "Ulaşım", desc: "Üsküdar ve Kadıköy motorlarının kalbi.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Besiktas_Pier_Istanbul.jpg/640px-Besiktas_Pier_Istanbul.jpg" },
            { title: "Üsküdar Vapur İskelesi", lat: 41.0275, lng: 29.0150, type: "cat-iskele", category: "Ulaşım", desc: "Marmaray ve vapurların kesişim noktası.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Uskudar_Square_Fountain.jpg/640px-Uskudar_Square_Fountain.jpg" },
            { title: "Karaköy Vapur İskelesi", lat: 41.0220, lng: 28.9750, type: "cat-iskele", category: "Ulaşım", desc: "Galata Kulesi'ne giden en kısa deniz yolu.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Galata_Tower_Istanbul.jpg/640px-Galata_Tower_Istanbul.jpg" },
            { title: "Ortaköy İskelesi", lat: 41.0470, lng: 29.0275, type: "cat-iskele", category: "Turistik", desc: "Boğaz turlarının popüler kalkış noktası.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Ortak%C3%B6y_Square_and_Mosque.jpg/640px-Ortak%C3%B6y_Square_and_Mosque.jpg" },

            // --- MEVCUT YERLER (Öncekiler) ---
            { title: "Taksim Meydanı", lat: 41.0369, lng: 28.9850, type: "cat-meydan", category: "Meydan", desc: "İstanbul'un kalbi.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Taksim_Square_and_Monument.jpg/640px-Taksim_Square_and_Monument.jpg" },
            { title: "Kadıköy Boğa Heykeli", lat: 40.9906, lng: 29.0296, type: "cat-meydan", category: "Meydan", desc: "Asya yakasının buluşma noktası.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/93/Kadikoy_Bull_Statue_2019.jpg/640px-Kadikoy_Bull_Statue_2019.jpg" },
            { title: "Sultanahmet Meydanı", lat: 41.0062, lng: 28.9758, type: "cat-meydan", category: "Meydan", desc: "Tarihi Hipodrom.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Sultanahmet_Square_Obelisks.jpg/640px-Sultanahmet_Square_Obelisks.jpg" },
            
            // ... (Kodun şişmemesi için diğer mevcut yerleri buraya eklediğini varsayıyorum, yukarıdaki listenin aynısı) ...
            { title: "Ayasofya-i Kebir Cami", lat: 41.0086, lng: 28.9802, type: "cat-tarih", category: "Tarihi", desc: "Mimari şaheser.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/22/Hagia_Sophia_Mars_2013.jpg/640px-Hagia_Sophia_Mars_2013.jpg" },
            { title: "Galata Kulesi", lat: 41.0256, lng: 28.9741, type: "cat-tarih", category: "Kule", desc: "Panoramik İstanbul manzarası.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Galata_Tower_Istanbul.jpg/640px-Galata_Tower_Istanbul.jpg" },
            { title: "Emirgan Korusu", lat: 41.1075, lng: 29.0536, type: "cat-park", category: "Koru", desc: "Lale Festivali merkezi.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Emirgan_Park_Yellow_Pavilion.jpg/640px-Emirgan_Park_Yellow_Pavilion.jpg" },
            { title: "İstanbul Modern", lat: 41.0260, lng: 28.9830, type: "cat-modern", category: "Müze", desc: "Modern sanat müzesi.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Istanbul_Modern_new_building_2023.jpg/640px-Istanbul_Modern_new_building_2023.jpg" },
             // ... Diğer tüm yerler burada kalacak ...
        ];

        locations.forEach(loc => {
            var selectedIcon;
            var targetLayer;
            var badgeClass = loc.type;

            if (loc.type === 'cat-tarih') { selectedIcon = redIcon; targetLayer = layerTarih; }
            else if (loc.type === 'cat-park') { selectedIcon = greenIcon; targetLayer = layerPark; }
            else if (loc.type === 'cat-meydan') { selectedIcon = orangeIcon; targetLayer = layerMeydan; }
            else if (loc.type === 'cat-muze') { selectedIcon = violetIcon; targetLayer = layerMuze; }
            else if (loc.type === 'cat-ibb') { selectedIcon = goldIcon; targetLayer = layerIBB; } // Yeni
            else if (loc.type === 'cat-iskele') { selectedIcon = greyIcon; targetLayer = layerIskele; } // Yeni
            else { selectedIcon = blueIcon; targetLayer = layerModern; }

            var marker = L.marker([loc.lat, loc.lng], {icon: selectedIcon});
            var popupContent = `
                <div>
                    <img src="${loc.img}" class="popup-img" alt="${loc.title}">
                    <div class="popup-details">
                        <span class="category-tag ${badgeClass}">${loc.category}</span>
                        <h3>${loc.title}</h3>
                        <p>${loc.desc}</p>
                        <a href="https://www.google.com/maps/dir/?api=1&destination=${loc.lat},${loc.lng}" target="_blank" class="btn-rota">YOL TARİFİ AL</a>
                    </div>
                </div>
            `;
            marker.bindPopup(popupContent);
            targetLayer.addLayer(marker);
        });

        // Tüm katmanları varsayılan olarak aç
        layerTarih.addTo(map);
        layerPark.addTo(map);
        layerMeydan.addTo(map);
        layerMuze.addTo(map);
        layerModern.addTo(map);
        layerIBB.addTo(map);
        layerIskele.addTo(map);

        var overlayMaps = {
            "<span style='color:#e74c3c'>■</span> Tarihi Yerler": layerTarih,
            "<span style='color:#2ecc71'>■</span> Parklar & Korular": layerPark,
            "<span style='color:#e67e22'>■</span> Meydanlar": layerMeydan,
            "<span style='color:#f1c40f'>■</span> İBB Sosyal Tesisleri": layerIBB, // Yeni
            "<span style='color:#7f8c8d'>■</span> Vapur İskeleleri": layerIskele, // Yeni
            "<span style='color:#9b59b6'>■</span> Müzeler": layerMuze,
            "<span style='color:#3498db'>■</span> Modern & Kültür": layerModern
        };

        var isMobile = window.innerWidth < 768;
        L.control.layers(null, overlayMaps, { collapsed: isMobile, position: 'topright' }).addTo(map);

    </script>
</body>
</html>
